<view class="tab-bar">
  <view class="tab-item {{tabIndex==0?'active':''}}" data-index="0" bindtap="switchTab">
    <text class="icon">📄</text>
    <text>战绩记录</text>
  </view>
  <view class="tab-item {{tabIndex==1?'active':''}}" data-index="1" bindtap="switchTab">
    <text class="icon">⏳</text>
    <text>待确认战绩</text>
  </view>
</view>
<view wx:if="{{tabIndex==0}}">
  <view class="mode-switch">
    <view class="mode-item {{modeIndex==0?'active':''}}" data-index="0" bindtap="switchMode">单打</view>
    <view class="mode-item {{modeIndex==1?'active':''}}" data-index="1" bindtap="switchMode">双打</view>
  </view>
  <view>
    <block wx:for="{{records}}" wx:key="index">
      <view data-index="{{index}}" bindtap="viewRecord">
        <record-card record="{{item}}" doubles="{{doubles}}" />
      </view>
    </block>
  </view>
</view>
<view wx:elif="{{tabIndex==1}}">
  <view class="mode-switch">
    <view class="mode-item {{pendingTabIndex==0?'active':''}}" data-index="0" bindtap="switchPendingMode">单打</view>
    <view class="mode-item {{pendingTabIndex==1?'active':''}}" data-index="1" bindtap="switchPendingMode">双打</view>
  </view>
  <view wx:if="{{pendingTabIndex==0}}">
    <block wx:for="{{pendingSingles}}" wx:key="index">
      <record-card record="{{item}}" doubles="{{false}}" showActions="{{true}}">
        <view slot="actions" class="action-bar">
          <text class="status">{{item.status}}</text>
          <view class="buttons">
            <button wx:if="{{item.canConfirm}}" data-index="{{index}}" bindtap="confirmSingle">确认</button>
            <button wx:if="{{item.canReject}}" data-index="{{index}}" bindtap="rejectSingle">拒绝</button>
            <button wx:if="{{item.canApprove}}" data-index="{{index}}" bindtap="approveSingle">通过</button>
            <button wx:if="{{item.canVeto}}" data-index="{{index}}" bindtap="vetoSingle">否决</button>
            <button open-type="share" data-index="{{index}}" data-type="single">分享</button>
          </view>
        </view>
      </record-card>
    </block>
  </view>
  <view wx:elif="{{pendingTabIndex==1}}">
    <block wx:for="{{pendingDoubles}}" wx:key="index">
      <record-card record="{{item}}" doubles="{{true}}" showActions="{{true}}">
        <view slot="actions" class="action-bar">
          <text class="status">{{item.status}}</text>
          <view class="buttons">
            <button wx:if="{{item.canConfirm}}" data-index="{{index}}" bindtap="confirmDouble">确认</button>
            <button wx:if="{{item.canReject}}" data-index="{{index}}" bindtap="rejectDouble">拒绝</button>
            <button wx:if="{{item.canApprove}}" data-index="{{index}}" bindtap="approveDouble">通过</button>
            <button wx:if="{{item.canVeto}}" data-index="{{index}}" bindtap="vetoDouble">否决</button>
            <button open-type="share" data-index="{{index}}" data-type="double">分享</button>
          </view>
        </view>
      </record-card>
    </block>
  </view>
</view>
<button class="fab" bindtap="addMatch">＋</button>
